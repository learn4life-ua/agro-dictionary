<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Професійний словник: Агрономія</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { font-family: 'Inter', sans-serif; }
    .highlight { background-color:#fde047; border-radius:.25rem; padding:0 .25rem; }
  </style>
</head>
<body class="bg-gray-100 text-gray-800">
  <div class="container mx-auto p-4 md:p-8 lg:p-12">
    <header class="text-center mb-8">
      <h1 class="text-4xl md:text-5xl font-extrabold text-green-700 mb-2 leading-tight">
        Професійний словник: Агрономія
      </h1>
      <p class="text-lg md:text-xl text-gray-600">
        Ключові терміни аграрної сфери з прикладами та аудіо.
      </p>
    </header>

    <div class="mb-6">
      <input id="searchInput" type="text" placeholder="Пошук слів..."
             class="w-full px-4 py-3 rounded-xl shadow-md border-2 border-gray-200 focus:outline-none focus:ring-2 focus:ring-green-500 transition duration-300">
    </div>

    <div id="cardsContainer" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6"></div>
  </div>

  <script>
    // !!! Поклади свої mp3 у папку /audio і пропиши імена нижче
    const dictionaryData = [
      { german:"der Boden", transcription:"[ˈboːdn̩]", ukrainian:"ґрунт", sentence:"Der Boden ist fruchtbar.", id:"audio/der_boden_ist_fruchtbar.mp3" },
      { german:"die Fruchtbarkeit", transcription:"[fʁʊxtbaʁˈkaɪ̯t]", ukrainian:"родючість", sentence:"Die Fruchtbarkeit des Bodens ist wichtig.", id:"audio/die_fruchtbarkeit_des_bodens_ist_wichtig.mp3" },
      { german:"der Acker", transcription:"[ˈakɐ]", ukrainian:"рілля", sentence:"Der Acker wurde gepflügt.", id:"audio/der_acker_wurde_gepfluegt.mp3" },
      { german:"die Aussaat", transcription:"[ˈaʊ̯saːt]", ukrainian:"посів", sentence:"Die Aussaat beginnt im Frühling.", id:null },
      { german:"säen", transcription:"[zɛːən]", ukrainian:"сіяти", sentence:"Wir säen das Saatgut im April.", id:"audio/wir_saeen_das_saatgut_im_april.mp3" },
      { german:"das Saatgut", transcription:"[ˈzaːtˌɡuːt]", ukrainian:"посівний матеріал", sentence:"Das Saatgut ist zertifiziert.", id:"audio/das_saatgut_ist_zertifiziert.mp3" }
    ];

    const escapeHtml = (s='') => s.replace(/[&<>"']/g, ch => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[ch]));
    const escapeRegex = (s='') => s.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');

    function highlightText(text, filter) {
      if (!filter) return escapeHtml(text);
      const safeFilter = escapeRegex(filter);
      const re = new RegExp(`(${safeFilter})`, 'gi');
      return escapeHtml(text).replace(re, '<span class="highlight">$1</span>');
    }

    function renderCards(filter = "") {
      const cards = document.getElementById('cardsContainer');
      cards.innerHTML = '';

      const filtered = dictionaryData.filter(item => {
        const search = `${item.german} ${item.ukrainian} ${item.transcription} ${item.sentence}`.toLowerCase();
        return search.includes(filter.toLowerCase());
      });

      filtered.forEach(item => {
        const hasAudio = !!item.id;
        const audioHtml = hasAudio
          ? `<div class=\"rounded-xl overflow-hidden shadow-inner w-full\">
               <audio controls preload=\"none\" class=\"w-full\">
                 <source src=\"${item.id}\" type=\"audio/mpeg\">
                 Ваш браузер не підтримує аудіо елемент.
               </audio>
             </div>`
          : `<p class=\"text-gray-400 text-sm italic\">Аудіо відсутнє</p>`;

        const card = document.createElement('div');
        card.className = "bg-white rounded-2xl shadow-md p-6 flex flex-col items-center gap-2 transition-all duration-300 hover:scale-[1.01]";
        card.innerHTML = `
          <span class=\"inline-block bg-green-100 text-green-700 text-sm font-semibold px-3 py-1 rounded-full mb-1\">#Агрономія</span>
          <h2 class=\"text-2xl font-bold text-green-800 text-center\">${highlightText(item.german, filter)}</h2>
          <p class=\"text-gray-600 text-sm\"><strong>Транскрипція:</strong> ${highlightText(item.transcription, filter)}</p>
          <p class=\"text-gray-600 text-sm\"><strong>Переклад:</strong> ${highlightText(item.ukrainian, filter)}</p>
          <p class=\"text-gray-700 text-center\"><strong>Приклад:</strong> ${highlightText(item.sentence, filter)}</p>
          ${audioHtml}
        `;
        cards.appendChild(card);
      });

      if (!filtered.length) {
        const empty = document.createElement('div');
        empty.className = "col-span-full text-center text-gray-500 italic";
        empty.textContent = "Нічого не знайдено. Спробуйте інший запит.";
        cards.appendChild(empty);
      }
    }

    function debounce(fn, wait=200) {
      let t; return (...args) => { clearTimeout(t); t = setTimeout(() => fn(...args), wait); };
    }

    window.addEventListener('load', () => {
      renderCards();
      const search = document.getElementById('searchInput');
      search.addEventListener('input', debounce(() => renderCards(search.value.trim()), 200));
    });
  </script>
</body>
</html>
